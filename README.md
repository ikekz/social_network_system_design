# System Design социальной сети для курса по System Design

### Ссылка на курс

https://balun.courses/courses/system_design

### Функциональные требования

- Аутентификация
- Просмотр ленты
- Формирование поста (загрузка фотографий, текстовое описание, геометка)
- Публикация поста
- Подписка на других пользователей
- Оценка постов
- Комментарии постов
- Поиск постов по пользователю, по месту, по оценке, по количеству отзывов в виде ТОПа
- Функционал личных сообщений

### Нефункциональные требования

- Через год аудитория 10 000 000 уникальных пользователей в день и будет продолжать расти
- Аудитория страны СНГ
- Взаимодействите через мобильные устройства и браузер
- Доступность 99.95%
- Данные храним всегда
- Каждый пользователь в день в среднем первоначальную ленту 10 раз
- Каждый пользователь в день в среднем размещает 0.1 пост
- Каждый пользователь в день в среднем смотрит дополнительную выдачу в ленте 5 раз
- Каждый пользователь в день в среднем оставляет 1 оценку
- Каждый пользователь в день в среднем оставляет 0.2 комментария
- Пост = id пользователя, время загрузки, список фотографий, текстовое описание, id геометки, количество оценок 1, количество оценок 2, количество оценок 3, количество оценок 4, количество оценок 5
- Геометка = id геометки, текстовое описание
- Оценка - целое число от 1 до 5
- В посте не более 10 фото
- 1 фото не более 5 мб
- Среднее количество фото в посте 2
- Средний размер фото 1 мб
- Размер первоначальной выдачи ленты для пользователя - 20 постов
- На первоначальную выдачу ленты для пользователя - не более 1 секунды
- Размер дополнительной выдачи ленты для пользователя - 20 постов
- На дополнительную выдачу ленты для пользователя - не более 3 секунд

### Расчет нагрузки

- Предположив линейный рост, получим через 5 лет - 50 000 000 уникальных пользователей
- Размер поста в ленте - 4б + 4б + 2 * 10^6б + 1000б + 4б + 1 * 4б = 2мб
- RPS
  - Просмотр ленты = 50000000 * 10 / 86400 = 6000
  - Размещение поста = 50000000 * 0.1 / 86400 = 60
  - Запрос дополнительной выдачи в ленте = 50000000 * 5 / 86400 = 3000
  - Оставление оценки = 50000000 * 1 / 86400 = 600
  - Оставление комментария = 50000000 * 0.2 / 86400 = 120
- Данные
  - Пусть за 5 лет количество пользователей росло линейно с 0 до 50 000 000 по месячно. Тогда за это время было написано (50000000 * 0.1 / 60 * 60) / 2 * 60 * 30 = 4 500 000 000 постов
  - Фото - 4 500 000 000 * 2 * 1 мб = 9 000 000 000 мб = 9 пб
  - Посты - 4 500 000 000 * (4б + 4б + 2 * 4б + 1000б + 4б + 5 * 4б) = 4.68 тб
- Количество одновременных соединений
  - 50000000 * 0.1 = 5000000 соединений
- Траффик
  - Просмотр ленты = 6000 * 2мб = 1.2 гб/с
  - Размещение поста = 60 * 2мб = 120 мб/с
  - Запрос дополнительной выдачи в ленте = 3000 * 2мб = 600 мб/с
